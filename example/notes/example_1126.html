<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><title>example</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
</head>
<body style="margin: 5px 5px 5px 5px; background-color: #ffffff;">
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;">So we start by importing the module, and specifying the log file:</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">import paramiko</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">paramiko.util.log_to_file('/tmp/paramiko.log')</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;"><br></span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;">We open an SSH transport:</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">host = "</span><a style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="http://example.com">example.com</a><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">"</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">port = 22</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">transport = paramiko.Transport((host, port))</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;"><br></span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;">Next we want to authenticate. We can do this with a password:</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">password = "example101"</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">username = "warrior"</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">transport.connect(username = username, password = password)</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;"><br></span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;">Another way is to use an SSH key:</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">import os</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">privatekeyfile = os.path.expanduser('~/.ssh/id_rsa')</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">mykey = paramiko.RSAKey.from_private_key_file(privatekeyfile)</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">username = 'warrior'</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">transport.connect(username = username, pkey = mykey)</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;"><br></span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;">Now we can start the SFTP client:</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">sftp = paramiko.SFTPClient.from_transport(transport)</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;"><br></span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;">Now lets pull a file across from the remote to the local system:</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">filepath = '/home/zeth/lenna.jpg'</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">localpath = '/home/zeth/lenna.jpg'</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">sftp.get(filepath, localpath)</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;"><br></span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;">Now lets go the other way:</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">filepath = '/home/zeth/lenna.jpg'</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">localpath = '/home/zeth/lenna.jpg'</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">sftp.put(filepath, localpath)</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;"><br></span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;">Lastly, we need to close the SFTP connection and the transport:</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">sftp.close()</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Courier New', 'Courier', monospace; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">transport.close()</span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;"><br></span></p>
<p style=" text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">In my humble opinion, one should not have to write so many lines or care about the SSH protocol just to send a file from a to b. In the </span><a style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: normal; color: #0000ff; background-color: transparent; text-decoration: underline;" href="http://commandline.org.uk/python/2008/may/29/sftp-python-really-simple-ssh/">next-post</a><span style=" font-size: 10pt; font-family: 'Verdana', 'Geneva', sans-serif; font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;">, I will share my own higher level API that runs on top of Paramiko.</span></p>
</body></html>
